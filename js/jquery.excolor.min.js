// Generated by CoffeeScript 1.3.3
/*
  ExColor for jQuery
  http://excolor.ramiro.mx
*/(function(){jQuery.fn.excolor=function(e){return e=jQuery.extend({hue_bar:0,hue_slider:0,sb_slider:0,color_box:!0,demo_mode:!1,show_color_on_border:!1,border_color:"black",sb_border_color:"black",anim_speed:"slow",round_corners:!0,shadow:!0,shadow_size:4,shadow_color:"#8a8a8a",background_color:"silver",backlight:!0,input_text_color:"black",input_background_color:"white",label_color:"black",effect:"none",root_path:!1,rgb_output:!1,callback_on_ok:function(){var e;return e=""}},e),this.each(function(){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,et,tt,nt,rt,it,st,ot,ut,at,ft,lt,ct,ht,pt,dt,vt,mt,gt,yt;x=function(){var t,n,r,i,o,u,a,f;o=jQuery.trim(jQuery(s).val()+""),i="";if(o==="")jQuery(_).val("").css("background","url("+rt+"transp.gif) repeat"),jQuery(mt).find("input").val("");else{if(o.match(tt))u=!0,a=W(o),i=Z(a[0],a[1],a[2]);else{r=0;while(r<o.length){if(o.charAt(r)!=="#"&&o.charAt(r)+""in gt?i.length<6:void 0)i+=o.charAt(r)+"";r++}switch(i.length){case 0:i="000000"+i;break;case 1:i="00000"+i;break;case 2:i="0000"+i;break;case 3:i="000"+i;break;case 4:i="00"+i;break;case 5:i="0"+i}}o=m(i),o=et(o.r,o.g,o.b),n=120-Math.round(o.h*1/3),n<0&&(n=0),n>119&&(n=119),f=o.s,t=o.v,jQuery(_).css("background","#"+i)}if(e.show_color_on_border)return jQuery(s).css("border-color","#"+i)},r=function(){var t,n;if(!n)return!1;jQuery(ft).remove(),jQuery(ot).remove(),jQuery(lt).remove(),t=!0;switch(e.effect){case"zoom":jQuery(mt).animate({width:"0px",height:"0px"},e.anim_speed,function(){return i(),jQuery(mt).remove()});break;case"slide":jQuery(mt).slideUp(e.anim_speed,function(){return i(),jQuery(mt).remove()});break;case"fade":jQuery(mt).fadeTo(e.anim_speed,0,function(){return i(),jQuery(mt).remove()});break;default:i(),jQuery(mt).remove()}return n=!1},i=function(){var t,n,r;if(r)return t="#"+Z(jQuery(O).val()*1,jQuery(L).val()*1,jQuery(k).val()*1),n=jQuery(O).val()*1+","+jQuery(L).val()*1+","+jQuery(k).val()*1,jQuery.trim(jQuery(O).val())===""&&jQuery.trim(jQuery(L).val())===""&&jQuery.trim(jQuery(k).val())===""?(jQuery(_).css("background","url("+rt+"transp.gif) repeat"),jQuery(s).val("")):(jQuery(_).css("background",t),e.show_color_on_border&&jQuery(s).css("border-color",t),nt?jQuery(s).val(n):jQuery(s).val(t)),r=!1,jQuery(s).trigger("change"),e.callback_on_ok()},v=function(){var e,t,n,r;return e=et(jQuery(O).val()*1,jQuery(L).val()*1,jQuery(k).val()*1),n=-1*(Math.round(e.h*1/3)-120),n<0&&(n=0),n>119&&(n=119),r=e.s,t=e.v,jQuery(ft).css("left",V.left+"px").css("top",V.top+n+"px"),N(),T(),jQuery(A).val(Z(jQuery(O).val()*1,jQuery(L).val()*1,jQuery(k).val()*1))},g=function(){var e,t,n,r,i,s,o;e=!0,r="",r=jQuery.trim(jQuery(A).val());switch(r.length){case 1:r="00000"+r;break;case 2:r="0000"+r;break;case 3:r="000"+r;break;case 4:r="00"+r;break;case 5:r="0"+r}if(r.length>0){s=0;while(s<r.length)r.charAt(s)+""in gt||(e=!1),s++}if(e){r===""?(i=119,o=0,n=0):(t=m(r),jQuery(O).val(t.r),jQuery(L).val(t.g),jQuery(k).val(t.b),t=et(t.r,t.g,t.b),i=-1*(Math.round(t.h*1/3)-120),i<0&&(i=0),i>119&&(i=119),o=t.s,n=t.v),jQuery(ft).css("left",V.left+"px").css("top",V.top+i+"px"),N(),T();if(r==="")return jQuery(h).css("background-image","url("+rt+"transp.gif)").css("background-repeat","repeat"),jQuery(_).val("").css("background","url("+rt+"transp.gif) repeat"),jQuery(lt).css("background","url("+rt+"transp0.gif) -20px 0 no-repeat"),jQuery(mt).find("input").val("")}},pt=function(){var e;return e=b(-1*(w-119)*3,st,a,"rgb"),jQuery(O).val(Math.round(e.r)*1),jQuery(L).val(Math.round(e.g)*1),jQuery(k).val(Math.round(e.b)*1),jQuery(A).val(Z(e.r,e.g,e.b))},b=function(e,t,n,r){var i,s,o,u,a,f,l,c,h,p,d,v;return o=e/360,u=t/100,a=n/100,i=new Array,s=void 0,d=void 0,f=void 0,l=void 0,c=void 0,v=void 0,p=void 0,u===0?(i.r=a*255,i.g=a*255,i.b=a*255):(s=o*6,d=Math.floor(s),f=a*(1-u),l=a*(1-u*(s-d)),c=a*(1-u*(1-(s-d))),d===0?(v=a,p=c,h=f):d===1?(v=l,p=a,h=f):d===2?(v=f,p=a,h=c):d===3?(v=f,p=l,h=a):d===4?(v=c,p=f,h=a):(v=a,p=f,h=l),i.r=Math.round(v*255),i.g=Math.round(p*255),i.b=Math.round(h*255)),r==="hex"?Z(i.r,i.g,i.b):r==="rgb"?i:i},m=function(e){var t,n,r,i,s;t=new String,t=e,t.toUpperCase(),e=t,i=void 0,s="0123456789ABCDEF",r="",n=new Array;if(e){e=e.toUpperCase(),i=0;while(i<6){switch(i){case 0:n.r=(16*s.indexOf(e.charAt(i))+s.indexOf(e.charAt(i+1)))*1;break;case 2:n.g=(16*s.indexOf(e.charAt(i))+s.indexOf(e.charAt(i+1)))*1;break;case 4:n.b=(16*s.indexOf(e.charAt(i))+s.indexOf(e.charAt(i+1)))*1}i+=2}}return n},et=function(e,t,n){var r,i,s,o,u,a,f;return s=0,a=0,i=0,u=0,f=0,r=0,o=new Array,u=0,s=Math.min(Math.min(e,t),n),a=Math.max(Math.max(e,t),n),i=a-s,r=a,a!==0?f=255*i/a:f=0,f!==0?e===a?u=(t-n)/i:t===a?u=2+(n-e)/i:n===a&&(u=4+(e-t)/i):u=-1,u*=60,u<0&&(u+=360),o.h=Math.round(u),o.s=Math.round(f*100/255),o.v=Math.round(r*100/255),o.h>360&&(o.h=360),o.s>100&&(o.s=100),o.v>100&&(o.v=100),o},W=function(e){var t;return t=e.split(","),t},Z=function(e,t,n){var r,i,s,o,u;r=new Array,r[0]=e,r[1]=t,r[2]=n,i=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],s="",u=0;while(u<r.length)o=parseInt(r[u]),s+=i[parseInt(o/16)]+i[o%16],u++;return s},N=function(){return jQuery(ft).css("left",V.left+"px").css("top",V.top+w+"px"),jQuery(ot).css("left",pos_sbbox.left+Math.round(st*1.3)-4+"px").css("top",pos_sbbox.top+jQuery(ut).height()-4-Math.round(a*1.3)+"px")},T=function(){return jQuery(ut).css("background-color","#"+b(-1*(w-119)*3,100,100,"hex")),jQuery(h).css("background-color","#"+b(-1*(w-119)*3,st,a,"hex")).css("background-image","none"),jQuery(lt).css("background","url("+rt+"transp0.gif) 0 0 no-repeat")},it=function(){var t,n,i,o,u,a,f,l,c,h,p,d,m,y,E,S,k,L,A,O;n=-1*e.hue_bar*20,i='<div id="excolor_sample_wrapper"><div id="excolor_sample"></div></div>',x(),jQuery("body").append('<div id="excolor_colorpicker"><div id="excolor_colorpicker_wrapper"><div id="excolor_grad_wrap"><div id="excolor_grad"><div style="width:130px;height:130px;float:left;background-image:url('+rt+'bg.png);background-position:0 0;background-repeat:no-repeat;border:1px solid white;padding:0;margin:0;"></div></div></div><div id="excolor_hue_wrap" style="width:20px;height:130px;float:left;padding:15px 8px 0px 10px;margin:0;border:none;"><div id="excolor_hue" style="width:20px;height:130px;float:left;background:url('+rt+"hue.png) "+n+'px 0 no-repeat;margin:0;padding:0;border:none;"></div></div><div id="excolor_data" style="float:left;font-size:10px;font-family: Verdana, Arial, Helvetica, Sans-serif;width:66px;height:140px;margin:0;padding:0;border:none;">'+i+'<div class="excolor_dataitem first"><b class="label">R</b><input id="excolor_r" class="excolor_input excolor_rgb" type="text" size="3" maxlength="3" /></div><div class="excolor_dataitem" style="float:left;padding:3px 0 0 0;margin:0;border:none;"><b class="label">G</b><input id="excolor_g" class="excolor_input excolor_rgb" type="text" size="3" maxlength="3" /></div><div class="excolor_dataitem"><b class="label">B</b><input id="excolor_b" class="excolor_input excolor_rgb" type="text" size="3" maxlength="3" /></div><div class="excolor_dataitem last"><b class="label">#</b><input id="excolor_hex" class="excolor_input" type="text" size="6" maxlength="6" /></div><div style="width:66px;height:15px;padding:0;margin:0;border:none;float:left;"><div id="excolor_ok">OK</div><div id="excolor_close">X</div></div></div></div></div><div id="excolor_picker"></div><div id="excolor_slider"></div><div id="excolor_switcher"></div>'),t=jQuery(s).offset(),O=jQuery("body > div#excolor_colorpicker").css("left",t.left+"px").css("top",t.top+jQuery(s).outerHeight()+"px").mouseenter(function(){var e;return clearTimeout(e),e=setTimeout(function(){var e;return e=!0},50)}).mouseleave(function(){var e;return clearTimeout(e),e=setTimeout(function(){var e;return e=!1},50)}),c=jQuery(O).find("input#excolor_hex"),A=jQuery("body > div#excolor_switcher"),L=jQuery("body > div#excolor_slider"),S=jQuery("body > div#excolor_picker");switch(e.effect){case"zoom":jQuery(O).css("width","0px").css("height","0px").show().animate({width:"265px",height:"162px"},e.anim_speed,function(){return jQuery(this).show(),jQuery("body > div#excolor_slider, body > div#excolor_picker").show(),jQuery(A).show()});break;case"slide":jQuery(O).slideDown(e.anim_speed,function(){return jQuery(this).show(),jQuery("body > div#excolor_slider, body > div#excolor_picker").show(),jQuery(A).show()});break;case"fade":jQuery("body > div#excolor_colorpicker, body > div#excolor_slider, body > div#excolor_picker, body > div#excolor_switcher").fadeTo(1,0,function(){return jQuery(this).show().fadeTo(e.anim_speed,1)});break;default:jQuery(O).show(),jQuery(A).show(),jQuery("body > div#excolor_slider, body > div#excolor_picker").show()}return a=jQuery(O).find("div#excolor_hue"),k=jQuery(O).find("div#excolor_grad div"),u=jQuery(O).find("#excolor_sample"),h=jQuery(O).find("input#excolor_r"),l=jQuery(O).find("input#excolor_g"),f=jQuery(O).find("input#excolor_b"),p=jQuery(O).find("#excolor_ok"),o=jQuery(O).find("#excolor_close"),E=jQuery(O).offset(),y=jQuery(k).offset(),m=jQuery(a).offset(),jQuery(A).click(function(){return jQuery.trim(jQuery(h).val())===""&&jQuery.trim(jQuery(l).val())===""&&jQuery.trim(jQuery(f).val())===""?(jQuery(u).css("background-image","none"),jQuery(this).css("background","url("+rt+"transp0.gif) 0 0 no-repeat"),pt()):(jQuery(u).css("background-image","url("+rt+"transp.gif)").css("background-repeat","repeat"),jQuery(O).find("input").val(""),jQuery(this).css("background","url("+rt+"transp0.gif) -20px 0 no-repeat"))}).css("left",m.left-1+"px").css("top",m.top-15+"px").mouseenter(function(){var e;return clearTimeout(e),e=setTimeout(function(){var e;return e=!0},50)}).mouseleave(function(){var e;return clearTimeout(e),e=setTimeout(function(){var e;return e=!1},50)}),jQuery(L).mouseenter(function(){var e;return clearTimeout(e),e=setTimeout(function(){var e;return e=!0},50)}).mouseleave(function(){var e;return clearTimeout(e),e=setTimeout(function(){var e;return e=!1},50)}),jQuery(S).mouseenter(function(){var e;return clearTimeout(e),e=setTimeout(function(){var e;return e=!0},50)}).mouseleave(function(){var e;return clearTimeout(e),e=setTimeout(function(){var e;return e=!1},50)}).dblclick(function(e){return jQuery(p).click()}),jQuery(S).mousedown(function(e){var t,n,r,i;return i=jQuery(this).offset(),t=e.pageX-i.left,n=e.pageY-i.top,r=this,jQuery(A).css("background","url("+rt+"transp0.gif) 0 0 no-repeat"),e.preventDefault()}).click(function(e){}),jQuery(L).mousedown(function(e){var t,n,r,i;return i=jQuery(this).offset(),t=e.pageX-i.left,n=e.pageY-i.top,r=this,jQuery(A).css("background","url("+rt+"transp0.gif) 0 0 no-repeat"),e.preventDefault()}),jQuery(a).mousedown(function(e){var t,n,r,i,s;if(e.pageY>=m.top+5&&e.pageY<=m.top+jQuery(a).height()-6)return r=e.pageY-m.top-5,r<0&&(r=0),r>119&&(r=119),jQuery(A).css("background","url("+rt+"transp0.gif) 0 0 no-repeat"),N(),T(),pt(),s=jQuery(L).offset(),t=e.pageX-s.left,n=e.pageY-s.top,i=L,e.preventDefault()}),jQuery(k).mousedown(function(e){var t,n,r,i,s,o;return o=Math.round((e.pageX-y.left-1)/1.3),o>100&&(o=100),o<1&&(o=1),t=-1*(Math.round((e.pageY-y.top-1)/1.3)-100),t>100&&(t=100),t<1&&(t=1),jQuery(A).css("background","url("+rt+"transp0.gif) 0 0 no-repeat"),N(),jQuery(u).css("background-color","#"+b(-1*(w-119)*3,o,t,"hex")).css("background-image","none"),pt(),i=S,s=jQuery(i).offset(),n=e.pageX-s.left,r=e.pageY-s.top,e.preventDefault()}),jQuery(O).find("input.excolor_input").keypress(function(e){if(jQuery(this).hasClass("excolor_rgb")){if(String.fromCharCode(e.which)*1 in vt&&e.which in yt)return e.preventDefault()}else if(!(String.fromCharCode(e.which)in gt)&&!(e.which in yt))return e.preventDefault()}).change(function(){return jQuery(this).hasClass("excolor_rgb")?(jQuery(this).val()===""&&jQuery(this).val("0"),isNaN(jQuery(this).val()*1)&&jQuery(this).val("0"),jQuery(this).val()*1>255&&jQuery(this).val("255"),jQuery(this).val()*1<0&&jQuery(this).val("0"),v()):g()}).keyup(function(){return jQuery(this).hasClass("excolor_rgb")?(jQuery(this).val()===""&&jQuery(this).val("0"),isNaN(jQuery(this).val()*1)&&jQuery(this).val("0"),jQuery(this).val()*1>255&&jQuery(this).val("255"),jQuery(this).val()*1<0&&jQuery(this).val("0"),v()):g()}),c[0].onpaste=c[0].oninput=function(e){var t;return clearTimeout(t),t=setTimeout(function(){return g()},100)},h[0].onpaste=h[0].oninput=l[0].onpaste=l[0].oninput=f[0].onpaste=f[0].oninput=function(e){var t;return jQuery(this).val()===""&&jQuery(this).val("0"),isNaN(jQuery(this).val()*1)&&jQuery(this).val("0"),jQuery(this).val()*1>255&&jQuery(this).val("255"),jQuery(this).val()*1<0&&jQuery(this).val("0"),clearTimeout(t),t=setTimeout(function(){return v()},100)},jQuery(p).click(function(){var e;return e=!0,r()}).mouseenter(function(){return jQuery(this).css("background-position","0 -15px")}).mouseleave(function(){return jQuery(this).css("background-position","0 0")}),jQuery(o).click(function(){return r()}).mouseenter(function(){return jQuery(this).css("background-position","-47px -15px")}).mouseleave(function(){return jQuery(this).css("background-position","-47px 0")}),N(),jQuery(c).val(M),g(),d=!0,M===""?jQuery(A).css("background","url("+rt+"transp0.gif) -20px 0 no-repeat"):jQuery(A).css("background","url("+rt+"transp0.gif) 0 0 no-repeat")},D="mel",F="mel",p=0,d=0,$=0,J=0,E=0,mt=0,K=0,V=0,w=0,ut=0,ot=0,st=1,a=1,ft=0,h=0,O=0,L=0,k=0,A=0,y=0,R=0,c=0,s=this,o=jQuery(this).offset(),U=!1,_=0,f=0,l=0,dt=!1,X="",M="",tt=/\d+\,\d+\,\d+/i,nt=e.rgb_output,B=0,lt=0,F=jQuery("script");if(!e.root_path){S=0;while(S<F.length)D=""+jQuery(F[S]).attr("src"),D=D.toLowerCase(),D=D.split("jquery.excolor.js"),D.length===2&&(rt=D[0]),S++}else rt=e.root_path;P=new Image,H=new Image,j=new Image,I=new Image,q=new Image,z=new Image,Q=new Image,ct=new Image,P.src=rt+"sel.gif",H.src=rt+"slider.gif",j.src=rt+"bg.png",I.src=rt+"hue.png",q.src=rt+"ok.png",z.src=rt+"shbg.png",Q.src=rt+"transp0.gif",ct.src=rt+"transp.gif",F="mel",D="mel",jQuery(s).mouseenter(function(){return clearTimeout(l),l=setTimeout(function(){return f=!0},100)}).mouseleave(function(){return clearTimeout(l),l=setTimeout(function(){return f=!1},100)}),e.color_box&&jQuery(s).wrap('<span style="margin:0;padding:0"></span>'),ht="",G="",Y="",at="",u="",e.round_corners&&(ht="-khtml-border-radius:2px;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;",G="-khtml-border-radius:2px;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;",Y="-khtml-border-radius: 0 2px 2px 2px;-moz-border-radius: 0 2px 2px 2px;-webkit-border-radius: 0 2px 2px 2px;border-radius: 0 2px 2px 2px;"),e.shadow&&(at="box-shadow:0 "+e.shadow_size+"px "+e.shadow_size*2+"px 0 "+e.shadow_color+";-webkit-box-shadow:0 "+e.shadow_size+"px "+e.shadow_size*2+"px 0 "+e.shadow_color+";-moz-box-shadow:0 "+e.shadow_size+"px "+e.shadow_size*2+"px 0 "+e.shadow_color+";"),e.backlight&&(u="background-position:0 0;background-repeat:no-repeat;background-image:url("+rt+"shbg.png);"),vt=new Array(0,1,2,3,4,5,6,7,8,9),vt[8]=8,vt[46]=46,gt=new Array,gt[0]=1,gt[1]=1,gt[2]=1,gt[3]=1,gt[4]=1,gt[5]=1,gt[6]=1,gt[7]=1,gt[8]=1,gt[9]=1,gt.A=1,gt.B=1,gt.C=1,gt.D=1,gt.E=1,gt.F=1,gt.a=1,gt.b=1,gt.c=1,gt.d=1,gt.e=1,gt.f=1,yt=new Array,yt[0]="system keys",yt[8]="backspace",yt[118]="ctrl v",yt[86]="ctrl v",yt[99]="ctrl c",yt[67]="ctrl c",t=" "+Math.random(),t=t.split("."),t="mc"+t[1],n=jQuery(s).parent().offset(),jQuery(s).parent().append('<input class="excolor_clrbox" readonly="readonly" id="'+t+'" type="text" />'),jQuery(s).clone().show().addClass("mds"+t).css("position","absolute").css("visibility","hidden").appendTo("body"),setTimeout(function(){var e;return e=jQuery("body > .mds"+t),jQuery(e).remove()},300),_=jQuery(s).parent().find("#"+t).mouseenter(function(){return clearTimeout(l),l=setTimeout(function(){return f=!0},50)}).mouseleave(function(){return clearTimeout(l),l=setTimeout(function(){return f=!1},50)}).focus(function(){return jQuery(s).focus()}),e.color_box&&setTimeout(function(){return jQuery(_).show()},150),x(),setTimeout(function(){return o=jQuery(s).offset()},200),jQuery(document).mouseup(function(e){return D="mel",F="mel"}).mousemove(function(e){var t,n;D!=="mel"&&(e.preventDefault(),t=0,n=0,t=e.pageX-p,t<pos_sbbox.left-4&&(t=pos_sbbox.left-4),t>pos_sbbox.left+125&&(t=pos_sbbox.left+125),n=e.pageY-d,n<pos_sbbox.top-4&&(n=pos_sbbox.top-4),n>pos_sbbox.top+125&&(n=pos_sbbox.top+125),jQuery(D).css("left",t+"px").css("top",n+"px"),a=-1*(Math.round((n-pos_sbbox.top+5)/1.3)-100)+1,st=Math.round((t-pos_sbbox.left+5)/1.3),a===1&&(a=0),st===1&&(st=0),jQuery(h).css("background-color","#"+b(-1*(w-119)*3,st,a,"hex")).css("background-image","none"),pt());if(F!=="mel")return e.preventDefault(),w=e.pageY-V.top-d,w<0&&(w=0),w>119&&(w=119),jQuery(F).css("left",V.left+"px").css("top",V.top+w+"px"),T(),pt()}).keydown(function(e){e.keyCode==="27"&&(e.preventDefault(),r());if(e.keyCode==="13")return e.preventDefault(),jQuery(R).click()}).click(function(){if(!f)return r()}),jQuery(s).click(function(){if(!U)return jQuery("body > div#excolor_slider, body > div#excolor_picker, body > div#excolor_colorpicker").stop().remove(),setTimeout(function(){return it()},50)}).keyup(function(){if(U)return x(),pt(),N(),jQuery(A).val(M),g()}),jQuery(_).click(function(){return jQuery(s).click()});if(e.demo_mode)return jQuery(_).click()})}}).call(this);